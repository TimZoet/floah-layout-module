#pragma once

////////////////////////////////////////////////////////////////
// Standard includes.
////////////////////////////////////////////////////////////////

#include <concepts>

////////////////////////////////////////////////////////////////
// Current target includes.
////////////////////////////////////////////////////////////////

#include "floah/element.h"
#include "floah/properties/size.h"

namespace floah
{
    class Layout
    {
    public:
        ////////////////////////////////////////////////////////////////
        // Constructors.
        ////////////////////////////////////////////////////////////////
        // TODO: Implement some kind of clone.
        Layout();

        Layout(const Layout&) = delete;

        Layout(Layout&&) noexcept = delete;

        ~Layout() noexcept;

        Layout& operator=(const Layout&) = delete;

        Layout& operator=(Layout&&) noexcept = delete;

        ////////////////////////////////////////////////////////////////
        // Getters.
        ////////////////////////////////////////////////////////////////

        [[nodiscard]] Size& getSize() noexcept;

        [[nodiscard]] const Size& getSize() const noexcept;

        [[nodiscard]] Element* getRootElement() const noexcept;

        ////////////////////////////////////////////////////////////////
        // Setters.
        ////////////////////////////////////////////////////////////////

        ////////////////////////////////////////////////////////////////
        // ...
        ////////////////////////////////////////////////////////////////

        template<std::derived_from<Element> T>
        T& setRoot(std::unique_ptr<T> elem)
        {
            assert(elem);
            auto& elemRef = *elem;
            root          = std::move(elem);
            root->setLayout(this);
            return elemRef;
        }

    private:
        ////////////////////////////////////////////////////////////////
        // Member variables.
        ////////////////////////////////////////////////////////////////

        Size size;

        ElementPtr root;
    };
}  // namespace floah